From bdb27f35c13820eeb2879f4447f1d3012cbe222d Mon Sep 17 00:00:00 2001
From: Akira Kakuto <kakuto@fuk.kindai.ac.jp>
Date: Tue, 21 May 2019 21:55:08 +0000
Subject: [PATCH 07/10] Fix a crash observed in add_ligature1_inverse_map().
 (S. Hirata)

git-svn-id: svn://tug.org/texlive/trunk/Build/source@51182 c570f23f-e606-0410-a88d-b1316a301751
---
 texk/dvipdfm-x/configure    | 22 +++++++++++-----------
 texk/dvipdfm-x/configure.ac |  2 +-
 texk/dvipdfm-x/tt_gsub.c    |  6 +++---
 3 files changed, 15 insertions(+), 15 deletions(-)

diff --git a/texk/dvipdfm-x/configure b/texk/dvipdfm-x/configure
index ef51242c1..e61e6c64c 100755
--- a/texk/dvipdfm-x/configure
+++ b/texk/dvipdfm-x/configure
@@ -1,6 +1,6 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.69 for dvipdfm-x (TeX Live) 20190503.
+# Generated by GNU Autoconf 2.69 for dvipdfm-x (TeX Live) 20190522.
 #
 # Report bugs to <dvipdfmx@tug.org>.
 #
@@ -590,8 +590,8 @@ MAKEFLAGS=
 # Identity of this package.
 PACKAGE_NAME='dvipdfm-x (TeX Live)'
 PACKAGE_TARNAME='dvipdfm-x--tex-live-'
-PACKAGE_VERSION='20190503'
-PACKAGE_STRING='dvipdfm-x (TeX Live) 20190503'
+PACKAGE_VERSION='20190522'
+PACKAGE_STRING='dvipdfm-x (TeX Live) 20190522'
 PACKAGE_BUGREPORT='dvipdfmx@tug.org'
 PACKAGE_URL=''
 
@@ -1350,7 +1350,7 @@ if test "$ac_init_help" = "long"; then
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures dvipdfm-x (TeX Live) 20190503 to adapt to many kinds of systems.
+\`configure' configures dvipdfm-x (TeX Live) 20190522 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
@@ -1421,7 +1421,7 @@ fi
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of dvipdfm-x (TeX Live) 20190503:";;
+     short | recursive ) echo "Configuration of dvipdfm-x (TeX Live) 20190522:";;
    esac
   cat <<\_ACEOF
 
@@ -1551,7 +1551,7 @@ fi
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-dvipdfm-x (TeX Live) configure 20190503
+dvipdfm-x (TeX Live) configure 20190522
 generated by GNU Autoconf 2.69
 
 Copyright (C) 2012 Free Software Foundation, Inc.
@@ -2390,7 +2390,7 @@ cat >config.log <<_ACEOF
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by dvipdfm-x (TeX Live) $as_me 20190503, which was
+It was created by dvipdfm-x (TeX Live) $as_me 20190522, which was
 generated by GNU Autoconf 2.69.  Invocation command line was
 
   $ $0 $@
@@ -8077,7 +8077,7 @@ fi
 
 # Define the identity of the package.
  PACKAGE='dvipdfm-x--tex-live-'
- VERSION='20190503'
+ VERSION='20190522'
 
 
 cat >>confdefs.h <<_ACEOF
@@ -14746,7 +14746,7 @@ Usage: $0 [OPTIONS]
 Report bugs to <bug-libtool@gnu.org>."
 
 lt_cl_version="\
-dvipdfm-x (TeX Live) config.lt 20190503
+dvipdfm-x (TeX Live) config.lt 20190522
 configured by $0, generated by GNU Autoconf 2.69.
 
 Copyright (C) 2011 Free Software Foundation, Inc.
@@ -16636,7 +16636,7 @@ cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by dvipdfm-x (TeX Live) $as_me 20190503, which was
+This file was extended by dvipdfm-x (TeX Live) $as_me 20190522, which was
 generated by GNU Autoconf 2.69.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
@@ -16706,7 +16706,7 @@ _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
 ac_cs_config="`$as_echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`"
 ac_cs_version="\\
-dvipdfm-x (TeX Live) config.status 20190503
+dvipdfm-x (TeX Live) config.status 20190522
 configured by $0, generated by GNU Autoconf 2.69,
   with options \\"\$ac_cs_config\\"
 
diff --git a/texk/dvipdfm-x/configure.ac b/texk/dvipdfm-x/configure.ac
index 69df97a54..58498e44c 100644
--- a/texk/dvipdfm-x/configure.ac
+++ b/texk/dvipdfm-x/configure.ac
@@ -7,7 +7,7 @@ dnl   This file is free software; the copyright holder
 dnl   gives unlimited permission to copy and/or distribute it,
 dnl   with or without modifications, as long as this notice is preserved.
 dnl
-AC_INIT([dvipdfm-x (TeX Live)], [20190503], [dvipdfmx@tug.org])
+AC_INIT([dvipdfm-x (TeX Live)], [20190522], [dvipdfmx@tug.org])
 AC_PREREQ([2.65])
 AC_CONFIG_SRCDIR([agl.c])
 AC_CONFIG_AUX_DIR([../../build-aux])
diff --git a/texk/dvipdfm-x/tt_gsub.c b/texk/dvipdfm-x/tt_gsub.c
index d88d729e7..fec2334bb 100644
--- a/texk/dvipdfm-x/tt_gsub.c
+++ b/texk/dvipdfm-x/tt_gsub.c
@@ -598,7 +598,7 @@ otl_gsub_read_alternate (struct otl_gsub_subtab *subtab, sfnt *sfont)
     len += 2;
     if (altset->GlyphCount == 0) {
       altset->Alternate = NULL;
-      break;
+      continue;
     }
     altset->Alternate = NEW(altset->GlyphCount, GlyphID);
     for (j = 0; j < altset->GlyphCount; j++) {
@@ -668,7 +668,7 @@ otl_gsub_read_ligature (struct otl_gsub_subtab *subtab, sfnt *sfont)
     ligset->LigatureCount = ligset_tab.count;
     if (ligset_tab.count == 0) {
       ligset->Ligature = NULL;
-      break;
+      continue;
     }
     ligset->Ligature = NEW(ligset_tab.count,
                            struct otl_gsub_ligtab);
@@ -678,7 +678,7 @@ otl_gsub_read_ligature (struct otl_gsub_subtab *subtab, sfnt *sfont)
       ligset->Ligature[j].CompCount = sfnt_get_ushort(sfont);
       if (ligset->Ligature[j].CompCount == 0) {
         ligset->Ligature[j].Component = NULL;
-        break;
+        continue;
       }
       ligset->Ligature[j].Component =
         NEW(ligset->Ligature[j].CompCount - 1, GlyphID);
-- 
2.23.0.rc1

