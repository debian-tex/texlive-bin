---
 texk/mendexk/ChangeLog    |    9 
 texk/mendexk/README       |  136 ++++++-------
 texk/mendexk/configure    |   22 +-
 texk/mendexk/configure.ac |    2 
 texk/mendexk/indexsty     |    2 
 texk/mendexk/kana.h       |  150 +++++++--------
 texk/mendexk/ktable.h     |  456 +++++++++++++++++++++++-----------------------
 texk/mendexk/main.c       |   10 -
 texk/mendexk/mendex.1     |    3 
 texk/mendexk/mendex.1.ja  |    2 
 texk/mendexk/mendex.doc   |    2 
 11 files changed, 400 insertions(+), 394 deletions(-)

--- a/texk/mendexk/ChangeLog
+++ b/texk/mendexk/ChangeLog
@@ -1,3 +1,12 @@
+2018-05-15  TANAKA Takuji  <ttk@t-lab.opal.ne.jp>
+
+	* README, main.c, configure.ac, configure:
+	Version 3.0 [15-May-2018].
+	* main.c, mendex.1, mendex.doc, mendex.1.ja:
+	Set default encoding of internal buffer UTF-8.
+	* README, indexsty, kana.h, ktable.h:
+	Convert encoding from EUC-JP to UTF-8
+
 2018-01-17  Karl Berry  <karl@tug.org>
 
 	* mendex.1 (.TH): use 1 instead of L, per Debian (and all our
--- a/texk/mendexk/README
+++ b/texk/mendexk/README
@@ -1,87 +1,87 @@
-<ġ mendex ver.2.6f>
-                                                     ҥ
+<索引整形ツール mendex ver.3.0>
+                                                     株式会社アスキー
                                                      www-ptex@ascii.co.jp
 
-<mendexȤ>
+<mendexとは>
 
- mendex  makeindex ߴLaTeXѺġǤ
- makeindexϴŪ˲ʸѤǤꡢʸ򰷤ǿȼ֤ݤޤ
- μ֤򸺤餹褦˿˺줿ΤmendexǤ
-
-<ħ>
-
-Ūmakeindexߴʲߴ
-  1. makeindexˤϺܤʬȤơֵס֥ե٥åȡפ¾ˡ
-     ΤߤιܤȤơֿפȤʬब롣mendexǤϿϡֵפ
-     ޤޤ롣
-     ޤʲmakeindexѥѥ᡼ǧʤ
+ mendex は makeindex 互換のLaTeX用索引整形ツールです。
+ makeindexは基本的に欧文用であり、和文を扱う上で色々と手間が掛かります。
+ それらの手間を減らすように新たに作成されたのがmendexです。
+
+<特徴>
+
+・基本的にmakeindex互換だが、以下の点で非互換。
+  1. makeindexには索引項目の分類として「記号」、「アルファベット」の他に、
+     数字のみの項目として「数字」という分類がある。mendexでは数字は「記号」に
+     含まれる。
+     また、以下のmakeindex用スタイルパラメータは認識されない。
        numhead_positive
        numhead_negative
-  2. makeindexιܤ¤ӽϡƬʸϡֵסֿס֥ե٥åȡפ
-     ʬ¤٤뤬2ʸܰʹߤñASCIIɽȤʤꡢ
-     ե٥åȤˤʤ⤢롣
-     mendexαѿ¤Ӥϡ2ʸܰʹߤֵסֿס֥ե٥åȡפ
-     ʬबθ롣
-  3. makeindexˤ -g ץǥɥĸ켭(->ե٥åȾʸ->
-     ե٥åʸ->)¤٤褦ˤǤ뤬mendexǤϥݡ
-     ʤ
-     -g ʸƬʸζڤڤ괹륪ץȤư
-ʸɤߤϤ򸺤餹ˡɤߤȽϸб뼭եѡ
-ʸɤߤϼ˼ưѴ
-->ʸ->ʸνˤʤκǽ
-makeindex٤Ƽ¹®٤٤
-
-<ưĶ>
-
- FreeBSD 5.3 ˤưǧ
-
-<ץΥѥ/󥹥ȡ>
-
- mendexˤTeX ver.3Υǥ쥯ȥ긡б뤿ˡɻ ŵ
-(asayama@vid.cpg.sony.co.jp)ˤkpathsea饤֥бʬ򤢤ƤƤޤ
- бƤ븡饤֥ kpathsea-2.6, 3.3, 3.4, 3.5 Ǥ
-
- 1. Υǥ쥯ȥ tetex-src  texk ǥ쥯ȥβŸޤ
-    tetex-3.0 ξ tetex-src-3.0/texk/mendexk2.6e ǥ쥯ȥˤʤޤ
-    tetex-src Τ򤢤餫 make ƤƤ
-
- 2. configure ¹ԤޤκݡǥեȤδɤꤷޤ
-    бƤɤ JIS, SJIS, EUC Ǥ
-    : EUCǻѤ
+  2. makeindexの項目の並び順は、頭文字は「記号」「数字」「アルファベット」に
+     分けて並べられるが、2文字目以降は単純にASCIIコード順となり、記号より
+     アルファベットが先になる場合もある。
+     mendexの英数字の並びは、2文字目以降も「記号」「数字」「アルファベット」の
+     分類が考慮される。
+  3. makeindexには -g オプションでドイツ語辞書順(記号->アルファベット小文字->
+     アルファベット大文字->数字)で並べるようにできるが、mendexではサポート
+     しない。
+     -g は和文頭文字の区切りを切り換えるオプションとして扱う。
+・和文索引の読みの入力を減らすために、読みと熟語を対応させる辞書ファイルを使用。
+・和文の読みは辞書順に自動変換。
+・数字・記号->欧文->和文の順にこだわらない索引の作成が可能。
+・makeindexと比べて実行速度が非常に遅い。
+
+<動作環境>
+
+ FreeBSD 5.3 にて動作確認。
+
+<プログラムのコンパイル/インストール>
+
+ このmendexにはTeX ver.3のディレクトリ検索に対応するために、淺山 和典氏
+(asayama@vid.cpg.sony.co.jp)によるkpathseaライブラリ対応差分をあててあります。
+ 対応している検索ライブラリは kpathsea-2.6, 3.3, 3.4, 3.5 です。
+
+ 1. このディレクトリを tetex-src の texk ディレクトリの下に展開します。
+    tetex-3.0 の場合は tetex-src-3.0/texk/mendexk2.6e ディレクトリになります。
+    tetex-src は全体をあらかじめ make しておいてください。
+
+ 2. configure を実行します。その際、デフォルトの漢字コードを指定します。
+    対応している漢字コードは JIS, SJIS, EUC です。
+    例: EUCで使用する場合
       ./configure EUC
 
- 3. make ; make install ¹Ԥޤ
+ 3. make ; make install を実行します。
 
-<kpathsea δĶѿˤĤ>
+<kpathsea の環境変数について>
 
- ѥkpathsea饤֥Ѥ硢texmf.cnf Ķѿǰʲ
-ѿꤹФ򻲾Ȥޤ
+ コンパイル時にkpathseaライブラリを使用した場合、texmf.cnf や環境変数で以下の
+変数を設定すればそれを参照します。
 
-  INDEXSTYLE   ե뤬ǥ쥯ȥ
-  INDEXDEFAULTSTYLE   ǥեȤǻȤե
-  INDEXDICTIONARY   񤬤ǥ쥯ȥ
-  INDEXDEFAULTDICTIONARY   ˻Ȥ뼭ե
+  ・INDEXSTYLE   索引スタイルファイルがあるディレクトリ
+  ・INDEXDEFAULTSTYLE   デフォルトで参照する索引スタイルファイル
+  ・INDEXDICTIONARY   辞書があるディレクトリ
+  ・INDEXDEFAULTDICTIONARY   常に参照する辞書ファイル
 
- ϡǥ쥯ȥ̾ ':' (Windows Ǥ ';') Ƕڤä¤٤ޤ(TEXINPUTS
-ʤɤƱ)TEXINPUTS Ʊ͡"//" ϺƵŪʸ̣ޤ
+ これらは、ディレクトリ名を ':' (Windows では ';') で区切って並べます(TEXINPUTS
+などと同じ)。TEXINPUTS と同様、"//" は再帰的な検索を意味します。
 
- ѿɤˤꤵƤʤХѥ main.c Ƭ
-DEFAULT_INDEXSTYLESDEFAULT_INDEXDICTS ǻꤷǥ쥯ȥѤޤ
-(ǥեȤǤϡ "." ꤷƤޤ)
+ これらの変数がどこにも設定されていなければコンパイル時に main.c 冒頭の
+DEFAULT_INDEXSTYLES、DEFAULT_INDEXDICTS で指定したディレクトリを用います
+(デフォルトでは、双方 "." が指定してあります)。
 
- δĶѿꤵƤʤ texmf.cnf ꤵ줿ѿ򸡺ޤ
+ これらの環境変数が設定されていなければ texmf.cnf に設定された変数を検索します。
 
- texmf.cnf ǤϡTeXʤɤƱͤˡINDEXSTYLE.mendex Τ褦˥ץ̾
-ꤷƻꤹ뤳Ȥޤ
+ texmf.cnf 内では、TeXなどと同様に、INDEXSTYLE.mendex のようにプログラム名を
+限定して指定することも出来ます。
 
- ޤINDEXDEFAULTDICTIONARY ˼ե̾ꤷƤоˤμ
-Ȥޤ
+ また、INDEXDEFAULTDICTIONARY に辞書ファイル名を設定しておけば常にその辞書を
+参照します。
 
-<۾>
+<配布条件等>
 
- mendexλѤۤ˴ؤƤϡ°COPYRIGHTե򻲾ȤƤ
+ mendexの使用および配布に関しては、付属のCOPYRIGHTファイルを参照してください。
 
-<䤤碌>
+<問い合わせ先>
 
- mendexˤĤƤΤ䤤碌ϡŻҥ᡼ www-ptex@ascii.co.jp Ƥˤꤤ
-ޤ
+ mendexについてのお問い合わせは、電子メールで www-ptex@ascii.co.jp 宛てにお願い
+します。
--- a/texk/mendexk/configure
+++ b/texk/mendexk/configure
@@ -1,6 +1,6 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.69 for mendex (TeX Live) 2.6f.
+# Generated by GNU Autoconf 2.69 for mendex (TeX Live) 3.0.
 #
 #
 # Copyright (C) 1992-1996, 1998-2012 Free Software Foundation, Inc.
@@ -587,8 +587,8 @@
 # Identity of this package.
 PACKAGE_NAME='mendex (TeX Live)'
 PACKAGE_TARNAME='mendex--tex-live-'
-PACKAGE_VERSION='2.6f'
-PACKAGE_STRING='mendex (TeX Live) 2.6f'
+PACKAGE_VERSION='3.0'
+PACKAGE_STRING='mendex (TeX Live) 3.0'
 PACKAGE_BUGREPORT=''
 PACKAGE_URL=''
 
@@ -1329,7 +1329,7 @@
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures mendex (TeX Live) 2.6f to adapt to many kinds of systems.
+\`configure' configures mendex (TeX Live) 3.0 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
@@ -1400,7 +1400,7 @@
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of mendex (TeX Live) 2.6f:";;
+     short | recursive ) echo "Configuration of mendex (TeX Live) 3.0:";;
    esac
   cat <<\_ACEOF
 
@@ -1521,7 +1521,7 @@
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-mendex (TeX Live) configure 2.6f
+mendex (TeX Live) configure 3.0
 generated by GNU Autoconf 2.69
 
 Copyright (C) 2012 Free Software Foundation, Inc.
@@ -2173,7 +2173,7 @@
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by mendex (TeX Live) $as_me 2.6f, which was
+It was created by mendex (TeX Live) $as_me 3.0, which was
 generated by GNU Autoconf 2.69.  Invocation command line was
 
   $ $0 $@
@@ -7858,7 +7858,7 @@
 
 # Define the identity of the package.
  PACKAGE='mendex--tex-live-'
- VERSION='2.6f'
+ VERSION='3.0'
 
 
 # Some tools Automake needs.
@@ -13910,7 +13910,7 @@
 Report bugs to <bug-libtool@gnu.org>."
 
 lt_cl_version="\
-mendex (TeX Live) config.lt 2.6f
+mendex (TeX Live) config.lt 3.0
 configured by $0, generated by GNU Autoconf 2.69.
 
 Copyright (C) 2011 Free Software Foundation, Inc.
@@ -15515,7 +15515,7 @@
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by mendex (TeX Live) $as_me 2.6f, which was
+This file was extended by mendex (TeX Live) $as_me 3.0, which was
 generated by GNU Autoconf 2.69.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
@@ -15581,7 +15581,7 @@
 cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
 ac_cs_config="`$as_echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`"
 ac_cs_version="\\
-mendex (TeX Live) config.status 2.6f
+mendex (TeX Live) config.status 3.0
 configured by $0, generated by GNU Autoconf 2.69,
   with options \\"\$ac_cs_config\\"
 
--- a/texk/mendexk/configure.ac
+++ b/texk/mendexk/configure.ac
@@ -6,7 +6,7 @@
 dnl   gives unlimited permission to copy and/or distribute it,
 dnl   with or without modifications, as long as this notice is preserved.
 dnl
-AC_INIT([mendex (TeX Live)], [2.6f])
+AC_INIT([mendex (TeX Live)], [3.0])
 AC_PREREQ([2.63])
 AC_CONFIG_SRCDIR([main.c])
 AC_CONFIG_AUX_DIR([../../build-aux])
--- a/texk/mendexk/indexsty
+++ b/texk/mendexk/indexsty
@@ -1,6 +1,6 @@
 preamble "\\documentclass{index}
 \\begin{document}\n
-\\chapter{}[index0001]\n
+\\chapter{索　引}[index0001]\n
 \\begin{theindex}\n\n"
 postamble "\n\n\\end{theindex}\n\n\\end{document}\n"
 
--- a/texk/mendexk/kana.h
+++ b/texk/mendexk/kana.h
@@ -1,90 +1,90 @@
 #include "exkana.h"
 
 char AKASATANA[]={
-	0xa4,0xa2, /*  */
-	0xa4,0xab, /*  */
-	0xa4,0xb5, /*  */
-	0xa4,0xbf, /*  */
-	0xa4,0xca, /*  */
-	0xa4,0xcf, /*  */
-	0xa4,0xde, /*  */
-	0xa4,0xe4, /*  */
-	0xa4,0xe9, /*  */
-	0xa4,0xef, /*  */
+	0xa4,0xa2, /* あ */
+	0xa4,0xab, /* か */
+	0xa4,0xb5, /* さ */
+	0xa4,0xbf, /* た */
+	0xa4,0xca, /* な */
+	0xa4,0xcf, /* は */
+	0xa4,0xde, /* ま */
+	0xa4,0xe4, /* や */
+	0xa4,0xe9, /* ら */
+	0xa4,0xef, /* わ */
 	0
 };
 char AKASATANAutf8[]={
-	0xe3,0x81,0x82, /*  */
-	0xe3,0x81,0x8b, /*  */
-	0xe3,0x81,0x95, /*  */
-	0xe3,0x81,0x9f, /*  */
-	0xe3,0x81,0xaa, /*  */
-	0xe3,0x81,0xaf, /*  */
-	0xe3,0x81,0xbe, /*  */
-	0xe3,0x82,0x84, /*  */
-	0xe3,0x82,0x89, /*  */
-	0xe3,0x82,0x8f, /*  */
+	0xe3,0x81,0x82, /* あ */
+	0xe3,0x81,0x8b, /* か */
+	0xe3,0x81,0x95, /* さ */
+	0xe3,0x81,0x9f, /* た */
+	0xe3,0x81,0xaa, /* な */
+	0xe3,0x81,0xaf, /* は */
+	0xe3,0x81,0xbe, /* ま */
+	0xe3,0x82,0x84, /* や */
+	0xe3,0x82,0x89, /* ら */
+	0xe3,0x82,0x8f, /* わ */
 	0
 };
 char *akasatana;
 
 char AIUEO[]={
-	0xa4,0xa2, /*  */
-	0xa4,0xa4, /*  */
-	0xa4,0xa6, /*  */
-	0xa4,0xa8, /*  */
-	0xa4,0xaa, /*  */
-	0xa4,0xab, /*  */
-	0xa4,0xad, /*  */
-	0xa4,0xaf, /*  */
-	0xa4,0xb1, /*  */
-	0xa4,0xb3, /*  */
-	0xa4,0xb5, /*  */
-	0xa4,0xb7, /*  */
-	0xa4,0xb9, /*  */
-	0xa4,0xbb, /*  */
-	0xa4,0xbd, /*  */
-	0xa4,0xbf, /*  */
-	0xa4,0xc1, /*  */
-	0xa4,0xc4, /*  */
-	0xa4,0xc6, /*  */
-	0xa4,0xc8, /*  */
-	0xa4,0xca, /*  */
-	0xa4,0xcb, /*  */
-	0xa4,0xcc, /*  */
-	0xa4,0xcd, /*  */
-	0xa4,0xce, /*  */
-	0xa4,0xcf, /*  */
-	0xa4,0xd2, /*  */
-	0xa4,0xd5, /*  */
-	0xa4,0xd8, /*  */
-	0xa4,0xdb, /*  */
-	0xa4,0xde, /*  */
-	0xa4,0xdf, /*  */
-	0xa4,0xe0, /*  */
-	0xa4,0xe1, /*  */
-	0xa4,0xe2, /*  */
-	0xa4,0xe4, /*  */
-	0xa4,0xe6, /*  */
-	0xa4,0xe8, /*  */
-	0xa4,0xe9, /*  */
-	0xa4,0xea, /*  */
-	0xa4,0xeb, /*  */
-	0xa4,0xec, /*  */
-	0xa4,0xed, /*  */
-	0xa4,0xef, /*  */
-	0xa4,0xf0, /*  */
-	0xa4,0xf1, /*  */
-	0xa4,0xf2, /*  */
-	0xa4,0xf3, /*  */
+	0xa4,0xa2, /* あ */
+	0xa4,0xa4, /* い */
+	0xa4,0xa6, /* う */
+	0xa4,0xa8, /* え */
+	0xa4,0xaa, /* お */
+	0xa4,0xab, /* か */
+	0xa4,0xad, /* き */
+	0xa4,0xaf, /* く */
+	0xa4,0xb1, /* け */
+	0xa4,0xb3, /* こ */
+	0xa4,0xb5, /* さ */
+	0xa4,0xb7, /* し */
+	0xa4,0xb9, /* す */
+	0xa4,0xbb, /* せ */
+	0xa4,0xbd, /* そ */
+	0xa4,0xbf, /* た */
+	0xa4,0xc1, /* ち */
+	0xa4,0xc4, /* つ */
+	0xa4,0xc6, /* て */
+	0xa4,0xc8, /* と */
+	0xa4,0xca, /* な */
+	0xa4,0xcb, /* に */
+	0xa4,0xcc, /* ぬ */
+	0xa4,0xcd, /* ね */
+	0xa4,0xce, /* の */
+	0xa4,0xcf, /* は */
+	0xa4,0xd2, /* ひ */
+	0xa4,0xd5, /* ふ */
+	0xa4,0xd8, /* へ */
+	0xa4,0xdb, /* ほ */
+	0xa4,0xde, /* ま */
+	0xa4,0xdf, /* み */
+	0xa4,0xe0, /* む */
+	0xa4,0xe1, /* め */
+	0xa4,0xe2, /* も */
+	0xa4,0xe4, /* や */
+	0xa4,0xe6, /* ゆ */
+	0xa4,0xe8, /* よ */
+	0xa4,0xe9, /* ら */
+	0xa4,0xea, /* り */
+	0xa4,0xeb, /* る */
+	0xa4,0xec, /* れ */
+	0xa4,0xed, /* ろ */
+	0xa4,0xef, /* わ */
+	0xa4,0xf0, /* ゐ */
+	0xa4,0xf1, /* ゑ */
+	0xa4,0xf2, /* を */
+	0xa4,0xf3, /* ん */
 	0
 };
 char *aiueo;
 
-char ONBIKI[]={0xa1,0xbc,0}; /*  */
-char SPACE[]={0xa1,0xa1,0}; /* ѥڡ */
-char ALPHAEND[]={0xa3,0xfa,0}; /*  */
-char HIRATOP[]={0xa4,0xa1,0}; /*  */
-char HIRAEND[]={0xa4,0xf3,0}; /*  */
-char KATATOP[]={0xa5,0xa1,0}; /*  */
-char KATAEND[]={0xa5,0xf6,0}; /*  */
+char ONBIKI[]={0xa1,0xbc,0}; /* ー */
+char SPACE[]={0xa1,0xa1,0}; /* 全角スペース */
+char ALPHAEND[]={0xa3,0xfa,0}; /* ｚ */
+char HIRATOP[]={0xa4,0xa1,0}; /* ぁ */
+char HIRAEND[]={0xa4,0xf3,0}; /* ん */
+char KATATOP[]={0xa5,0xa1,0}; /* ァ */
+char KATAEND[]={0xa5,0xf6,0}; /* ヶ */
--- a/texk/mendexk/ktable.h
+++ b/texk/mendexk/ktable.h
@@ -1,244 +1,244 @@
 char hiragana[200];
 char katakana[200];
 char kanatable[]={
-	0xa4,0xa2, /*  */
-	0xa4,0xa2, /*  */
-	0xa4,0xa4, /*  */
-	0xa4,0xa4, /*  */
-	0xa4,0xa6, /*  */
-	0xa4,0xa6, /*  */
-	0xa4,0xa8, /*  */
-	0xa4,0xa8, /*  */
-	0xa4,0xaa, /*  */
-	0xa4,0xaa, /*  */
-	0xa4,0xab, /*  */
-	0xa4,0xab, /*  */
-	0xa4,0xad, /*  */
-	0xa4,0xad, /*  */
-	0xa4,0xaf, /*  */
-	0xa4,0xaf, /*  */
-	0xa4,0xb1, /*  */
-	0xa4,0xb1, /*  */
-	0xa4,0xb3, /*  */
-	0xa4,0xb3, /*  */
-	0xa4,0xb5, /*  */
-	0xa4,0xb5, /*  */
-	0xa4,0xb7, /*  */
-	0xa4,0xb7, /*  */
-	0xa4,0xb9, /*  */
-	0xa4,0xb9, /*  */
-	0xa4,0xbb, /*  */
-	0xa4,0xbb, /*  */
-	0xa4,0xbd, /*  */
-	0xa4,0xbd, /*  */
-	0xa4,0xbf, /*  */
-	0xa4,0xbf, /*  */
-	0xa4,0xc1, /*  */
-	0xa4,0xc1, /*  */
-	0xa4,0xc4, /*  */
-	0xa4,0xc4, /*  */
-	0xa4,0xc4, /*  */
-	0xa4,0xc6, /*  */
-	0xa4,0xc6, /*  */
-	0xa4,0xc8, /*  */
-	0xa4,0xc8, /*  */
-	0xa4,0xca, /*  */
-	0xa4,0xcb, /*  */
-	0xa4,0xcc, /*  */
-	0xa4,0xcd, /*  */
-	0xa4,0xce, /*  */
-	0xa4,0xcf, /*  */
-	0xa4,0xcf, /*  */
-	0xa4,0xcf, /*  */
-	0xa4,0xd2, /*  */
-	0xa4,0xd2, /*  */
-	0xa4,0xd2, /*  */
-	0xa4,0xd5, /*  */
-	0xa4,0xd5, /*  */
-	0xa4,0xd5, /*  */
-	0xa4,0xd8, /*  */
-	0xa4,0xd8, /*  */
-	0xa4,0xd8, /*  */
-	0xa4,0xdb, /*  */
-	0xa4,0xdb, /*  */
-	0xa4,0xdb, /*  */
-	0xa4,0xde, /*  */
-	0xa4,0xdf, /*  */
-	0xa4,0xe0, /*  */
-	0xa4,0xe1, /*  */
-	0xa4,0xe2, /*  */
-	0xa4,0xe4, /*  */
-	0xa4,0xe4, /*  */
-	0xa4,0xe6, /*  */
-	0xa4,0xe6, /*  */
-	0xa4,0xe8, /*  */
-	0xa4,0xe8, /*  */
-	0xa4,0xe9, /*  */
-	0xa4,0xea, /*  */
-	0xa4,0xeb, /*  */
-	0xa4,0xec, /*  */
-	0xa4,0xed, /*  */
-	0xa4,0xef, /*  */
-	0xa4,0xef, /*  */
-	0xa4,0xf0, /*  */
-	0xa4,0xf1, /*  */
-	0xa4,0xf2, /*  */
-	0xa4,0xf3, /*  */
-	0xa4,0xa6, /*  */
-	0xa4,0xab, /*  */
-	0xa4,0xab, /*  */
+	0xa4,0xa2, /* あ */
+	0xa4,0xa2, /* あ */
+	0xa4,0xa4, /* い */
+	0xa4,0xa4, /* い */
+	0xa4,0xa6, /* う */
+	0xa4,0xa6, /* う */
+	0xa4,0xa8, /* え */
+	0xa4,0xa8, /* え */
+	0xa4,0xaa, /* お */
+	0xa4,0xaa, /* お */
+	0xa4,0xab, /* か */
+	0xa4,0xab, /* か */
+	0xa4,0xad, /* き */
+	0xa4,0xad, /* き */
+	0xa4,0xaf, /* く */
+	0xa4,0xaf, /* く */
+	0xa4,0xb1, /* け */
+	0xa4,0xb1, /* け */
+	0xa4,0xb3, /* こ */
+	0xa4,0xb3, /* こ */
+	0xa4,0xb5, /* さ */
+	0xa4,0xb5, /* さ */
+	0xa4,0xb7, /* し */
+	0xa4,0xb7, /* し */
+	0xa4,0xb9, /* す */
+	0xa4,0xb9, /* す */
+	0xa4,0xbb, /* せ */
+	0xa4,0xbb, /* せ */
+	0xa4,0xbd, /* そ */
+	0xa4,0xbd, /* そ */
+	0xa4,0xbf, /* た */
+	0xa4,0xbf, /* た */
+	0xa4,0xc1, /* ち */
+	0xa4,0xc1, /* ち */
+	0xa4,0xc4, /* つ */
+	0xa4,0xc4, /* つ */
+	0xa4,0xc4, /* つ */
+	0xa4,0xc6, /* て */
+	0xa4,0xc6, /* て */
+	0xa4,0xc8, /* と */
+	0xa4,0xc8, /* と */
+	0xa4,0xca, /* な */
+	0xa4,0xcb, /* に */
+	0xa4,0xcc, /* ぬ */
+	0xa4,0xcd, /* ね */
+	0xa4,0xce, /* の */
+	0xa4,0xcf, /* は */
+	0xa4,0xcf, /* は */
+	0xa4,0xcf, /* は */
+	0xa4,0xd2, /* ひ */
+	0xa4,0xd2, /* ひ */
+	0xa4,0xd2, /* ひ */
+	0xa4,0xd5, /* ふ */
+	0xa4,0xd5, /* ふ */
+	0xa4,0xd5, /* ふ */
+	0xa4,0xd8, /* へ */
+	0xa4,0xd8, /* へ */
+	0xa4,0xd8, /* へ */
+	0xa4,0xdb, /* ほ */
+	0xa4,0xdb, /* ほ */
+	0xa4,0xdb, /* ほ */
+	0xa4,0xde, /* ま */
+	0xa4,0xdf, /* み */
+	0xa4,0xe0, /* む */
+	0xa4,0xe1, /* め */
+	0xa4,0xe2, /* も */
+	0xa4,0xe4, /* や */
+	0xa4,0xe4, /* や */
+	0xa4,0xe6, /* ゆ */
+	0xa4,0xe6, /* ゆ */
+	0xa4,0xe8, /* よ */
+	0xa4,0xe8, /* よ */
+	0xa4,0xe9, /* ら */
+	0xa4,0xea, /* り */
+	0xa4,0xeb, /* る */
+	0xa4,0xec, /* れ */
+	0xa4,0xed, /* ろ */
+	0xa4,0xef, /* わ */
+	0xa4,0xef, /* わ */
+	0xa4,0xf0, /* ゐ */
+	0xa4,0xf1, /* ゑ */
+	0xa4,0xf2, /* を */
+	0xa4,0xf3, /* ん */
+	0xa4,0xa6, /* う */
+	0xa4,0xab, /* か */
+	0xa4,0xab, /* か */
 	0
 };
 char symboltable[]={
-	0xa1,0xa1, /* ڡ */
-	0xa1,0xaa, /*  */
-	0xa1,0xc9, /*  */
-	0xa1,0xf4, /*  */
-	0xa1,0xf0, /*  */
-	0xa1,0xf3, /*  */
-	0xa1,0xf5, /*  */
-	0xa1,0xc7, /*  */
-	0xa1,0xca, /*  */
-	0xa1,0xcb, /*  */
-	0xa1,0xf6, /*  */
-	0xa1,0xdc, /*  */
-	0xa1,0xa4, /*  */
-	0xa1,0xdd, /*  */
-	0xa1,0xa5, /*  */
-	0xa1,0xbf, /*  */
-	0xa3,0xb0, /*  */
-	0xa3,0xb1, /*  */
-	0xa3,0xb2, /*  */
-	0xa3,0xb3, /*  */
-	0xa3,0xb4, /*  */
-	0xa3,0xb5, /*  */
-	0xa3,0xb6, /*  */
-	0xa3,0xb7, /*  */
-	0xa3,0xb8, /*  */
-	0xa3,0xb9, /*  */
-	0xa1,0xa7, /*  */
-	0xa1,0xa8, /*  */
-	0xa1,0xe3, /*  */
-	0xa1,0xe1, /*  */
-	0xa1,0xe4, /*  */
-	0xa1,0xa9, /*  */
-	0xa1,0xf7, /*  */
-	0xa3,0xc1, /*  */
-	0xa3,0xc2, /*  */
-	0xa3,0xc3, /*  */
-	0xa3,0xc4, /*  */
-	0xa3,0xc5, /*  */
-	0xa3,0xc6, /*  */
-	0xa3,0xc7, /*  */
-	0xa3,0xc8, /*  */
-	0xa3,0xc9, /*  */
-	0xa3,0xca, /*  */
-	0xa3,0xcb, /*  */
-	0xa3,0xcc, /*  */
-	0xa3,0xcd, /*  */
-	0xa3,0xce, /*  */
-	0xa3,0xcf, /*  */
-	0xa3,0xd0, /*  */
-	0xa3,0xd1, /*  */
-	0xa3,0xd2, /*  */
-	0xa3,0xd3, /*  */
-	0xa3,0xd4, /*  */
-	0xa3,0xd5, /*  */
-	0xa3,0xd6, /*  */
-	0xa3,0xd7, /*  */
-	0xa3,0xd8, /*  */
-	0xa3,0xd9, /*  */
-	0xa3,0xda, /*  */
-	0xa1,0xce, /*  */
-	0xa1,0xef, /*  */
-	0xa1,0xcf, /*  */
-	0xa1,0xb0, /*  */
-	0xa1,0xb2, /*  */
-	0xa1,0xc6, /*  */
-	0xa3,0xe1, /*  */
-	0xa3,0xe2, /*  */
-	0xa3,0xe3, /*  */
-	0xa3,0xe4, /*  */
-	0xa3,0xe5, /*  */
-	0xa3,0xe6, /*  */
-	0xa3,0xe7, /*  */
-	0xa3,0xe8, /*  */
-	0xa3,0xe9, /*  */
-	0xa3,0xea, /*  */
-	0xa3,0xeb, /*  */
-	0xa3,0xec, /*  */
-	0xa3,0xed, /*  */
-	0xa3,0xee, /*  */
-	0xa3,0xef, /*  */
-	0xa3,0xf0, /*  */
-	0xa3,0xf1, /*  */
-	0xa3,0xf2, /*  */
-	0xa3,0xf3, /*  */
-	0xa3,0xf4, /*  */
-	0xa3,0xf5, /*  */
-	0xa3,0xf6, /*  */
-	0xa3,0xf7, /*  */
-	0xa3,0xf8, /*  */
-	0xa3,0xf9, /*  */
-	0xa3,0xfa, /*  */
-	0xa1,0xd0, /*  */
-	0xa1,0xc3, /*  */
-	0xa1,0xd1, /*  */
-	0xa1,0xc1, /*  */
+	0xa1,0xa1, /* スペース */
+	0xa1,0xaa, /* ！ */
+	0xa1,0xc9, /* ” */
+	0xa1,0xf4, /* ＃ */
+	0xa1,0xf0, /* ＄ */
+	0xa1,0xf3, /* ％ */
+	0xa1,0xf5, /* ＆ */
+	0xa1,0xc7, /* ’ */
+	0xa1,0xca, /* （ */
+	0xa1,0xcb, /* ） */
+	0xa1,0xf6, /* ＊ */
+	0xa1,0xdc, /* ＋ */
+	0xa1,0xa4, /* ， */
+	0xa1,0xdd, /* − */
+	0xa1,0xa5, /* ． */
+	0xa1,0xbf, /* ／ */
+	0xa3,0xb0, /* ０ */
+	0xa3,0xb1, /* １ */
+	0xa3,0xb2, /* ２ */
+	0xa3,0xb3, /* ３ */
+	0xa3,0xb4, /* ４ */
+	0xa3,0xb5, /* ５ */
+	0xa3,0xb6, /* ６ */
+	0xa3,0xb7, /* ７ */
+	0xa3,0xb8, /* ８ */
+	0xa3,0xb9, /* ９ */
+	0xa1,0xa7, /* ： */
+	0xa1,0xa8, /* ； */
+	0xa1,0xe3, /* ＜ */
+	0xa1,0xe1, /* ＝ */
+	0xa1,0xe4, /* ＞ */
+	0xa1,0xa9, /* ？ */
+	0xa1,0xf7, /* ＠ */
+	0xa3,0xc1, /* Ａ */
+	0xa3,0xc2, /* Ｂ */
+	0xa3,0xc3, /* Ｃ */
+	0xa3,0xc4, /* Ｄ */
+	0xa3,0xc5, /* Ｅ */
+	0xa3,0xc6, /* Ｆ */
+	0xa3,0xc7, /* Ｇ */
+	0xa3,0xc8, /* Ｈ */
+	0xa3,0xc9, /* Ｉ */
+	0xa3,0xca, /* Ｊ */
+	0xa3,0xcb, /* Ｋ */
+	0xa3,0xcc, /* Ｌ */
+	0xa3,0xcd, /* Ｍ */
+	0xa3,0xce, /* Ｎ */
+	0xa3,0xcf, /* Ｏ */
+	0xa3,0xd0, /* Ｐ */
+	0xa3,0xd1, /* Ｑ */
+	0xa3,0xd2, /* Ｒ */
+	0xa3,0xd3, /* Ｓ */
+	0xa3,0xd4, /* Ｔ */
+	0xa3,0xd5, /* Ｕ */
+	0xa3,0xd6, /* Ｖ */
+	0xa3,0xd7, /* Ｗ */
+	0xa3,0xd8, /* Ｘ */
+	0xa3,0xd9, /* Ｙ */
+	0xa3,0xda, /* Ｚ */
+	0xa1,0xce, /* ［ */
+	0xa1,0xef, /* ￥ */
+	0xa1,0xcf, /* ］ */
+	0xa1,0xb0, /* ＾ */
+	0xa1,0xb2, /* ＿ */
+	0xa1,0xc6, /* ‘ */
+	0xa3,0xe1, /* ａ */
+	0xa3,0xe2, /* ｂ */
+	0xa3,0xe3, /* ｃ */
+	0xa3,0xe4, /* ｄ */
+	0xa3,0xe5, /* ｅ */
+	0xa3,0xe6, /* ｆ */
+	0xa3,0xe7, /* ｇ */
+	0xa3,0xe8, /* ｈ */
+	0xa3,0xe9, /* ｉ */
+	0xa3,0xea, /* ｊ */
+	0xa3,0xeb, /* ｋ */
+	0xa3,0xec, /* ｌ */
+	0xa3,0xed, /* ｍ */
+	0xa3,0xee, /* ｎ */
+	0xa3,0xef, /* ｏ */
+	0xa3,0xf0, /* ｐ */
+	0xa3,0xf1, /* ｑ */
+	0xa3,0xf2, /* ｒ */
+	0xa3,0xf3, /* ｓ */
+	0xa3,0xf4, /* ｔ */
+	0xa3,0xf5, /* ｕ */
+	0xa3,0xf6, /* ｖ */
+	0xa3,0xf7, /* ｗ */
+	0xa3,0xf8, /* ｘ */
+	0xa3,0xf9, /* ｙ */
+	0xa3,0xfa, /* ｚ */
+	0xa1,0xd0, /* ｛ */
+	0xa1,0xc3, /* ｜ */
+	0xa1,0xd1, /* ｝ */
+	0xa1,0xc1, /* 〜 */
 	0
 };
 char btable[6][21]={
-	{0xa4,0xa2, /*  */
-	0xa4,0xab, /*  */
-	0xa4,0xb5, /*  */
-	0xa4,0xbf, /*  */
-	0xa4,0xca, /*  */
-	0xa4,0xcf, /*  */
-	0xa4,0xde, /*  */
-	0xa4,0xe4, /*  */
-	0xa4,0xe9, /*  */
-	0xa4,0xef, /*  */
+	{0xa4,0xa2, /* あ */
+	0xa4,0xab, /* か */
+	0xa4,0xb5, /* さ */
+	0xa4,0xbf, /* た */
+	0xa4,0xca, /* な */
+	0xa4,0xcf, /* は */
+	0xa4,0xde, /* ま */
+	0xa4,0xe4, /* や */
+	0xa4,0xe9, /* ら */
+	0xa4,0xef, /* わ */
 	0},
-	{0xa4,0xa4, /*  */
-	0xa4,0xad, /*  */
-	0xa4,0xb7, /*  */
-	0xa4,0xc1, /*  */
-	0xa4,0xcb, /*  */
-	0xa4,0xd2, /*  */
-	0xa4,0xdf, /*  */
-	0xa4,0xea, /*  */
-	0xa4,0xf0, /*  */
+	{0xa4,0xa4, /* い */
+	0xa4,0xad, /* き */
+	0xa4,0xb7, /* し */
+	0xa4,0xc1, /* ち */
+	0xa4,0xcb, /* に */
+	0xa4,0xd2, /* ひ */
+	0xa4,0xdf, /* み */
+	0xa4,0xea, /* り */
+	0xa4,0xf0, /* ゐ */
 	0},
-	{0xa4,0xa6, /*  */
-	0xa4,0xaf, /*  */
-	0xa4,0xb9, /*  */
-	0xa4,0xc4, /*  */
-	0xa4,0xcc, /*  */
-	0xa4,0xd5, /*  */
-	0xa4,0xe0, /*  */
-	0xa4,0xe6, /*  */
-	0xa4,0xeb, /*  */
+	{0xa4,0xa6, /* う */
+	0xa4,0xaf, /* く */
+	0xa4,0xb9, /* す */
+	0xa4,0xc4, /* つ */
+	0xa4,0xcc, /* ぬ */
+	0xa4,0xd5, /* ふ */
+	0xa4,0xe0, /* む */
+	0xa4,0xe6, /* ゆ */
+	0xa4,0xeb, /* る */
 	0},
-	{0xa4,0xa8, /*  */
-	0xa4,0xb1, /*  */
-	0xa4,0xbb, /*  */
-	0xa4,0xc6, /*  */
-	0xa4,0xcd, /*  */
-	0xa4,0xd8, /*  */
-	0xa4,0xe1, /*  */
-	0xa4,0xec, /*  */
-	0xa4,0xf1, /*  */
+	{0xa4,0xa8, /* え */
+	0xa4,0xb1, /* け */
+	0xa4,0xbb, /* せ */
+	0xa4,0xc6, /* て */
+	0xa4,0xcd, /* ね */
+	0xa4,0xd8, /* へ */
+	0xa4,0xe1, /* め */
+	0xa4,0xec, /* れ */
+	0xa4,0xf1, /* ゑ */
 	0},
-	{0xa4,0xaa, /*  */
-	0xa4,0xb3, /*  */
-	0xa4,0xbd, /*  */
-	0xa4,0xc8, /*  */
-	0xa4,0xce, /*  */
-	0xa4,0xdb, /*  */
-	0xa4,0xe2, /*  */
-	0xa4,0xe8, /*  */
-	0xa4,0xed, /*  */
+	{0xa4,0xaa, /* お */
+	0xa4,0xb3, /* こ */
+	0xa4,0xbd, /* そ */
+	0xa4,0xc8, /* と */
+	0xa4,0xce, /* の */
+	0xa4,0xdb, /* ほ */
+	0xa4,0xe2, /* も */
+	0xa4,0xe8, /* よ */
+	0xa4,0xed, /* ろ */
 	0},
-	{0xa4,0xf3, /*  */
+	{0xa4,0xf3, /* ん */
 	0}
 };
--- a/texk/mendexk/main.c
+++ b/texk/mendexk/main.c
@@ -19,7 +19,7 @@
 #endif
 KpathseaSupportInfo kp_ist,kp_dict;
 
-#define VERSION "version 2.6f [14-Aug-2009]"
+#define VERSION "version 3.0 [15-May-2018]"
 
 int main(int argc, char **argv)
 {
@@ -31,11 +31,9 @@
 
 #ifdef WIN32
 	_setmaxstdio(2048);
-        set_enc_string("sjis", "euc");
-        sjisterminal = 0;
-#else
-        set_enc_string(NULL, "euc");
+	sjisterminal = 0;
 #endif
+	set_enc_string(NULL, "uptex");
 	kpse_set_program_name(argv[0], "mendex");
 
 	p = getenv ("PTEX_KANJI_ENC");
@@ -176,7 +174,7 @@
 #endif
 
 			case 'U':
-				set_enc_string("UTF8", "uptex");
+				set_enc_string("UTF8", NULL);
 				break;
 
 
--- a/texk/mendexk/mendex.1
+++ b/texk/mendexk/mendex.1
@@ -87,8 +87,7 @@
 \fB-I\fI enc\fR
 Set internal encoding to \fIenc\fR. The argument \fIenc\fR
 may be \fIeuc\fR (EUC-JP) or \fIutf8\fR (UTF-8).
-The normal default is set to \fIeuc\fR, but the default is changed to \fIutf8\fR
-when the option \fB-U\fR is specified explicitly.
+The default is set to \fIutf8\fR.
 .TP 10
 \fB--help\fR
 Show summary of options.
--- a/texk/mendexk/mendex.1.ja
+++ b/texk/mendexk/mendex.1.ja
@@ -65,7 +65,7 @@
 .TP 10
 \fB-I\fI enc\fR
 内部バッファのコードを\fIenc\fR に指定します。\fIenc\fR には \fIeuc\fR (EUC-JP) または \fIutf8\fR (UTF-8)が指定可能です。
-このオプションが指定されていない場合のデフォルト値は \fIeuc\fR ですが、オプション \fB-U\fR が明示的に指定されている場合は \fIutf8\fR となります。
+このオプションが指定されていない場合のデフォルト値は \fIutf8\fR です。
 .TP 10
 \fB--help\fR
 オプションの要約を表示します。
--- a/texk/mendexk/mendex.doc
+++ b/texk/mendexk/mendex.doc
@@ -70,7 +70,7 @@
            入力ファイル、出力ファイルともUTF-8として扱います。
 
    -I enc  内部バッファのコードをencに指定します。enc には euc (EUC-JP) または utf8 (UTF-8) が指定可能です。
-           このオプションが指定されていない場合のデフォルト値は euc ですが、オプション -U が明示的に指定されている場合は utf8 となります。
+           このオプションが指定されていない場合のデフォルト値は utf8 です。
 
    --help  オプションの要約を表示します。
 
